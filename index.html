<!DOCTYPE html>
<html lang="zh-tw">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="icon" href="asset/favicon.ico">

    <title>麻將紀錄</title>

    <!-- Bootstrap core CSS -->
    <link href="asset/bootstrap.min.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->

    <style type="text/css">
    .no-padding{
        padding: 0;
    } 
    .no-visibe{
        visibility: hidden;
    }
    .red{
        color: red;
    }
    </style>
  </head>

  <body>
    <div id="mj" class="container">

        <div class="page-header">
            <h1>麻將紀錄</h1>
            <p class="lead">紀錄麻將每回合的結果</p>
        </div>

        <h3>資訊</h3>
        <button class="btn btn-default" v-on="click:setWind(999)">修改玩家</button>
        <div v-show="settingStep >= 0">
            <form class="form-horizontal">
                <div class="form-group">
                    <div class="col-xs-2">
                        <input v-model="users[settingStep]['name']">
                    </div>
                    <div class="col-xs-10">                         
                        是<button type="button" class="btn btn-default btn-lg" v-repeat="winds" v-show="windArray.indexOf($index) == -1" v-on="click: setWind($index)" v-text="$value"></button>
                    </div>
                </div>
            </form>
        </div>
        <p><span v-text="winds[wind_count]"></span>風<span v-text="winds[wind_count2]"></span>， <span v-text="users[banker].name"></span>當莊 ，連莊數:<strong v-text="s.banker_count"></strong></p>
        <div class="row">
            <div class="col-xs-3" v-repeat="users | orderBy 'wind'">
                <h4 v-text="name"></h4>
                <kbd v-text="winds[wind]"></kbd>
                <strong v-text="money" v-class="red:money<0"></strong>
            </div>            
        </div>

        <div v-show="set == 1">
            <h3>新增</h3>
            <div class="row">
                <div class="col-xs-offset-1 col-xs-2">
                    類型
                </div>
                <div>
                    <label class="radio-inline" v-repeat="winType">
                        <input type="radio" name="type" value="{{ $index }}" v-model="winNo" v-on="click: changeDetail()"  number> {{ $value }}
                    </label>                
                </div>            
            </div>

            <div class="row" v-show="winNo == 0 || winNo == 1">
                <div class="col-xs-offset-1 col-xs-2">
                    贏家
                </div>
                <div>
                    <label class="radio-inline" v-repeat="users">
                        <input type="radio" name="win" value="{{ $index }}" v-model="userWin" v-on="click: changeDetail()"> <span v-text="name"></span>
                    </label>                
                </div>            
            </div>

            <div class="row" v-show="winNo == 0 && userWin >= 0">
                <div class="col-xs-offset-1 col-xs-2">
                    輸家
                </div>
                <span v-repeat="users">
                    <label class="radio-inline" v-if="$index != userWin">
                        <input type="radio" name="lose" value="{{ $index }}" v-model="userLose" v-on="click: changeDetail()"> <span v-text="name"></span>
                    </label>                
                </span>            
            </div>

            <div class="row" v-show="(winNo == 0 && userWin >= 0 && userLose >= 0) || (winNo == 1 && userWin >= 0)">
                <div class="col-xs-offset-1 col-xs-2">
                    台數
                </div>
                <div class="col-xs-offset-3">
                    <label class="checkbox-inline" v-repeat="kinds">
                        <input type="checkbox" name="num" v-model="kindArray[$index]" v-on="click: changeDetail()"> <span v-text="name"></span>
                    </label>                
                </div>            
            </div>
            <button class="btn btn-primary" v-show="(winNo == 0 && userWin >= 0 && userLose >= 0) || (winNo == 1 && userWin >= 0) || winNo == 2" v-on="click: set=2">Go</button>
            <button class="btn btn-default" v-show="set == 1" v-on="click:set = 0">取消</button>
        </div>

        <div v-show="set == 2">
            <h3>明細</h3>
            <div class="row">
                <div class="col-xs-offset-1 col-xs-2">
                    明細
                </div>
                <label class="col-xs-2" v-repeat="users">
                  <span v-text="name"></span>
                  <input class="col-xs-8 no-padding" type="number" v-model="log[$index]">
                </label>     
            </div>

            <!--<div class="row">
                <div class="col-xs-offset-1 col-xs-2">
                    下一局莊家
                </div>
                <div class="col-xs-7">
                    <label class="radio-inline" v-repeat="users">
                        <input type="radio" name="banker" value="{{ $index }}" v-model="s.next_banker"> <span v-text="name"></span>
                    </label>                
                </div>
            </div>-->

            <div class="row">
                <div class="col-xs-offset-1 col-xs-2">
                    下一局連莊數
                </div>
                <div class="col-xs-7">
                    <input type="number" name="banker_count" v-model="s.next_banker_count"> 
                </div>
            </div>

            <div class="row">
                <div class="col-xs-offset-1 col-xs-2">
                    備註
                </div>
                <div class="col-xs-7">
                    <input type="text" name="note" v-model="note"> 
                </div>
            </div>
            <button class="btn btn-primary" v-on="click: insertLog()">確認無誤</button>
            <button class="btn btn-default" v-on="click: set=1">回上一步</button>
        </div>

        <button class="btn btn-primary" v-show="set == 0" v-on="click: set=1">新增紀錄</button>
        <button class="btn btn-danger" v-show="set == 0 && logs.length" v-on="click: deleteLog()">刪除最新一筆紀錄</button>

        <h3>記錄區</h3>
        <div class="table-responsive">            
            <table class="table table-hover table-striped">
                <thead>
                    <tr>
                        <th>風</th>
                        <th v-repeat="users" v-text="name"></th> 
                    </tr>
                </thead>
                <tbody v-repeat="logs">
                    <tr v-on="click: showLog(this)">
                        <td v-text="winds[wind_count]"></td>
                        <td v-repeat="log" v-text="$value" v-class="red : $value<0"></td>
                    </tr>
                    <tr v-show="show">
                        <td colspan="5"><abbr class="timeago" title="{{ts}}">{{ts}}</abbr> {{ winds[wind_count]}}風{{ winds[wind_count2]}} <span v-text="note"></span></td>                        
                    </tr>
                </tbody>
            </table>
        </div>
    <pre>{{ $data | json}}</pre>

    </div>

    <script src="asset/jquery-1.11.3.min.js"></script>
    <script src="asset/jquery.cookie.js"></script>
    <script src="asset/jquery.timeago.js"></script>
    <script src="asset/bootstrap.min.js"></script>
    <script src="asset/vue.min.js"></script>
    <script src="asset/my.js"></script>
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-53250580-3', 'auto');
      ga('send', 'pageview');        
    </script>
  </body>
</html>
