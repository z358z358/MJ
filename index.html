<!DOCTYPE html>
<html lang="zh-tw">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="icon" href="asset/favicon.ico">

    <title>麻將紀錄</title>

    <!-- Bootstrap core CSS -->
    <link href="asset/bootstrap.min.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->

    <style type="text/css">
    .no-padding{
        padding: 0;
    } 
    .margin{
        margin: 2.5px 0 2.5px 0;
    }
    </style>
  </head>

  <body>
    <div id="mj" class="container">
        <div class="page-header">
            <h1>麻將紀錄</h1>
            <p class="lead">紀錄麻將每回合的結果</p>
        </div>
        
        <button class="btn btn-default" v-on="click:setWind(999)">修改玩家</button>
        <button class="btn btn-default" v-on="click:saveKind()">修改設定</button>
        <div class="row" v-show="dataSetting">
            <div class="row margin">                
                <div class="col-xs-7 col-sm-5">
                    <label>
                        <input type="checkbox" v-model="s.showMoney"> 顯示為金錢
                    </label>
                </div>
                <div class="col-xs-5 col-sm-3">
                    <button type="button" class="btn btn-primary" v-on="click:saveKind()">確定</button>
                </div>
            </div>

            <div class="row margin">
            <div class="col-xs-6 col-sm-4">
                底幾台
                <input type="number" class="form-control" v-model="s.basic">
            </div>
            <div class="col-xs-6 col-sm-4">
                <label>一台多少錢</label>
                <input type="number" class="form-control" v-model="s.point">
            </div>
            </div>        

            <div class="col-xs-12 col-sm-8 margin">
                <label class="col-xs-5">名稱</label>
                <label class="col-xs-3">台數</label>
                <button type="button" class="btn btn-primary col-xs-2" v-on="click:addKind">新增</button>
            </div>

            <div class="col-sm-8 col-xs-12 margin" v-repeat="kinds">
                <div class="col-xs-5">                    
                    <input type="text" class="form-control" v-model="name">
                </div>
                <div class="col-xs-3">
                    <input type="number" class="form-control " v-model="point">
                </div>
                <button type="button" class="btn btn-danger col-xs-2" v-on="click:removeKind(this)">刪除</button>
            </div>
            <div class="clearfix"></div>
        </div>
        <div v-show="settingStep >= 0">
            <h4>修改玩家名稱，風位</h4>
            <div class="col-md-3 col-xs-4">
                <input class="col-xs-12" v-model="users[settingStep]['name']" placeholder="名稱">
            </div>
            <div class="col-xs-8">
                <button type="button" class="btn btn-default col-xs-6 col-sm-2" v-repeat="winds" v-show="windArray.indexOf($index) == -1" v-on="click: setWind($index)" v-text="$value"></button> 
            </div>
        </div>
        <div class="clearfix"></div>
        <hr>

        <h3>資訊</h3>
        <h5><kbd v-text="winds[wind_count]"></kbd>風<kbd v-text="winds[wind_count2]"></kbd>， <kbd v-text="users[banker].name"></kbd>當莊 ，連莊數:<strong v-text="s.banker_count"></strong></h5>
        <div class="row">
            <div class="col-xs-3" v-repeat="users | orderBy 'wind'" v-class="bg-success: wind_count2 == wind">
                <h4 v-text="name"></h4>
                <kbd v-if="wind_count2 == wind && s.banker_count" v-text="'x'+s.banker_count"></kbd>
                <kbd v-text="winds[wind]"></kbd>
                <strong v-text="money | showMoney" v-class="text-danger:money<0"></strong>
            </div>            
        </div>
        <hr>

        <div v-show="set == 1">
            <h3>新增</h3>
            <div class="row">
                <div class="col-xs-offset-1 col-xs-2">
                    類型
                </div>
                <div>
                    <label class="radio-inline" v-repeat="winType">
                        <input type="radio" name="type" value="{{ $index }}" v-model="winNo" v-on="click: changeDetail()"  number> {{ $value }}
                    </label>                
                </div>            
            </div>

            <div class="row" v-show="winNo == 0 || winNo == 1">
                <div class="col-xs-offset-1 col-xs-2">
                    贏家
                </div>
                <div>
                    <label class="radio-inline" v-repeat="users">
                        <input type="radio" name="win" value="{{ $index }}" v-model="userWin" v-on="click: changeDetail()"> <span v-text="name"></span>
                    </label>                
                </div>            
            </div>

            <div class="row" v-show="winNo == 0 && userWin >= 0">
                <div class="col-xs-offset-1 col-xs-2">
                    輸家
                </div>
                <span v-repeat="users">
                    <label class="radio-inline" v-if="$index != userWin">
                        <input type="radio" name="lose" value="{{ $index }}" v-model="userLose" v-on="click: changeDetail()"> <span v-text="name"></span>
                    </label>                
                </span>            
            </div>

            <div class="row" v-show="(winNo == 0 && userWin >= 0 && userLose >= 0) || (winNo == 1 && userWin >= 0)">
                <div class="col-xs-offset-1 col-xs-2">
                    台數
                </div>
                <div class="col-xs-offset-3">
                    <label class="checkbox-inline" v-repeat="kinds" v-show="point == 1">
                        <input type="checkbox" name="num" v-model="kindArray[$index]" v-on="click: changeDetail()" > 
                        <span class="text-muted" v-text="name"></span>                                                  
                    </label>   
                    <label class="checkbox-inline" v-repeat="kinds" v-show="point == 2">
                        <input type="checkbox" name="num" v-model="kindArray[$index]" v-on="click: changeDetail()"> 
                        <span class="text-primary" v-text="name"></span>  
                    </label>   
                    <label class="checkbox-inline " v-repeat="kinds" v-show="point > 2"> 
                        <input type="checkbox" name="num" v-model="kindArray[$index]" v-on="click: changeDetail()"> 
                        <span class="text-danger" v-text="name"></span>                         
                    </label>               
                </div>            
            </div>
            <button class="btn btn-primary" v-show="(winNo == 0 && userWin >= 0 && userLose >= 0) || (winNo == 1 && userWin >= 0) || winNo == 2" v-on="click: set=2">Go</button>
            <button class="btn btn-default" v-show="set == 1" v-on="click:set = 0">取消</button>
        </div>

        <div v-show="set == 2">
            <h3>明細</h3>
            <div class="row">
                <label class="col-xs-3" v-repeat="users">
                  <span class="col-xs-5 no-padding" v-text="name"></span>
                  <input class="col-xs-7 no-padding" type="number" v-model="log[$index]">
                </label>     
            </div>

            <!--<div class="row">
                <div class="col-xs-offset-1 col-xs-2">
                    下一局莊家
                </div>
                <div class="col-xs-7">
                    <label class="radio-inline" v-repeat="users">
                        <input type="radio" name="banker" value="{{ $index }}" v-model="s.next_banker"> <span v-text="name"></span>
                    </label>                
                </div>
            </div>-->

            <div class="row">
                <div class="col-md-2 col-xs-3">
                    下一局連莊數
                </div>
                <div class="col-xs-4">
                    <input type="number" name="banker_count" v-model="s.next_banker_count"> 
                </div>
            </div>

            <div class="row">
                <div class="col-md-2 col-xs-3">
                    備註
                </div>
                <div class="col-xs-9">
                    <input type="text" name="note" v-model="note"> 
                </div>
            </div>
            <button class="btn btn-primary" v-on="click: insertLog()">確認無誤</button>
            <button class="btn btn-default" v-on="click: set=1">回上一步</button>
        </div>       

        <h3>記錄區 <button class="btn btn-primary" v-show="set == 0" v-on="click: set=1">新增紀錄</button></h3>
        <div class="table-responsive">            
            <table class="table table-hover table-striped">
                <thead>
                    <tr>
                        <th>風</th>
                        <th v-repeat="users" v-text="name"></th> 
                    </tr>
                </thead>
                <tbody v-repeat="logs">
                    <tr v-on="click: showLog(this)">
                        <td v-text="winds[wind_count]"></td>
                        <td v-repeat="log" v-text="$value | showMoney" v-class="text-danger : $value<0"></td>
                    </tr>
                    <tr v-show="show">
                        <td colspan="5"><abbr class="timeago" title="{{ts}}">{{ts}}</abbr> {{ winds[wind_count]}}風{{ winds[wind_count2]}} <span v-text="note"></span></td>                        
                    </tr>
                </tbody>
            </table>
        </div>              
        <button class="btn btn-danger" v-show="set == 0 && logs.length" v-on="click: deleteLog()">刪除最新一筆紀錄</button>
        <button class="btn btn-danger" v-show="set == 0 && logs.length" v-on="click: deleteLog('all')">刪除所有紀錄</button>
        <button class="btn btn-danger" v-on="click: reset()">回復初始設定</button>

        <!-- ad -->
        <ins class="adsbygoogle"
             style="display:block"
             data-ad-client="ca-pub-5518310153941700"
             data-ad-slot="5554403276"
             data-ad-format="auto"></ins>
    </div>

    <script src="asset/jquery-1.11.3.min.js"></script>
    <script src="asset/jquery.cookie.js"></script>
    <script src="asset/jquery.timeago.js"></script>
    <script src="asset/bootstrap.min.js"></script>
    <script src="asset/vue.min.js"></script>
    <script src="asset/my.js"></script>
    <!-- google ad -->
    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
    </script>

    <!-- ga -->
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-53250580-3', 'auto');
      ga('send', 'pageview');        
    </script>
  </body>
</html>
